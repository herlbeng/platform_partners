, ltm_kpis_data AS (
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_new_cust, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_ncust__trend, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue NCust  Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_rcust__trend, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue RCust  Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_demand, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_maint, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_estimates, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Estimates' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_projects, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Projects' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_total, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue TOTAL' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_pace, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue PACE' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.revenue_rev_trend, 0) AS tag_value, cm.month_offset, CAST('Revenue' AS STRING) AS tag, CAST('Revenue Rev Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_new_cust, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_ncust__trend, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs NCust  Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_new_cust_ib, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs New Cust IB' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_new_cust_ob, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs New Cust OB' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_r_cust_ob, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs R Cust OB' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_r_cust_ib, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs R Cust IB' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_r_cust_ib_pace, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs R Cust IB PACE' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_r_ib_trend, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs R IB Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_demand, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_maint, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_total, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs Total' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_pace, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs PACE' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.single_jobs_sj_trend, 0) AS tag_value, cm.month_offset, CAST('Single Jobs' AS STRING) AS tag, CAST('Single Jobs SJ Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_new_cust, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_r_cust, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_demand, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_maint, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_actual, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA actual' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_pace, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA pace' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.gba_trend, 0) AS tag_value, cm.month_offset, CAST('GBA' AS STRING) AS tag, CAST('GBA Trend' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_new_cust, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_demand, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_maint, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_est, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % Est' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.opportunity_to_pct_total, 0) AS tag_value, cm.month_offset, CAST('Opportunity TO %' AS STRING) AS tag, CAST('Opportunity TO % Total' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.to_conversion_pct_new_cust, 0) AS tag_value, cm.month_offset, CAST('TO Conversion %' AS STRING) AS tag, CAST('TO Conversion % New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.to_conversion_pct_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('TO Conversion %' AS STRING) AS tag, CAST('TO Conversion % Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.to_conversion_pct_demand, 0) AS tag_value, cm.month_offset, CAST('TO Conversion %' AS STRING) AS tag, CAST('TO Conversion % Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.to_conversion_pct_maint, 0) AS tag_value, cm.month_offset, CAST('TO Conversion %' AS STRING) AS tag, CAST('TO Conversion % Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.to_conversion_pct_total, 0) AS tag_value, cm.month_offset, CAST('TO Conversion %' AS STRING) AS tag, CAST('TO Conversion % Total' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.conversion_usd_avg_new_cust, 0) AS tag_value, cm.month_offset, CAST('Conversion $AVG' AS STRING) AS tag, CAST('Conversion $AVG New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.conversion_usd_avg_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('Conversion $AVG' AS STRING) AS tag, CAST('Conversion $AVG Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.conversion_usd_avg_demand, 0) AS tag_value, cm.month_offset, CAST('Conversion $AVG' AS STRING) AS tag, CAST('Conversion $AVG Demand' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.conversion_usd_avg_maint, 0) AS tag_value, cm.month_offset, CAST('Conversion $AVG' AS STRING) AS tag, CAST('Conversion $AVG Maint' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.conversion_usd_avg_total, 0) AS tag_value, cm.month_offset, CAST('Conversion $AVG' AS STRING) AS tag, CAST('Conversion $AVG Total' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.af_prj_avg_usd_new_cust, 0) AS tag_value, cm.month_offset, CAST('AF PRJ AVG $' AS STRING) AS tag, CAST('AF PRJ AVG $ New Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.af_prj_avg_usd_repeat_cust, 0) AS tag_value, cm.month_offset, CAST('AF PRJ AVG $' AS STRING) AS tag, CAST('AF PRJ AVG $ Repeat Cust' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month
 UNION ALL 
SELECT cm.company_new_name, cm.middle_point, cm.month_date, COALESCE(cr.af_prj_avg_usd_total, 0) AS tag_value, cm.month_offset, CAST('AF PRJ AVG $' AS STRING) AS tag, CAST('AF PRJ AVG $ Total' AS STRING) AS subtag FROM company_months cm LEFT JOIN `gp-technologies-dev.silver.ltm_kpis_consolidate_group2` cr ON cm.company_new_name = cr.company_new_name AND EXTRACT(YEAR FROM cm.month_date) = cr.year AND EXTRACT(MONTH FROM cm.month_date) = cr.month