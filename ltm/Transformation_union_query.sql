--Version Anterior (Por los detalles):
CREATE OR REPLACE TABLE {table} AS (
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,CAST(EXTRACT(MONTH FROM month) AS INT64) AS month_num,CAST(EXTRACT(YEAR FROM month) AS INT64) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table1_id}
WHERE status != false
UNION ALL
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,CAST(EXTRACT(MONTH FROM month) AS INT64) AS month_num,CAST(EXTRACT(YEAR FROM month) AS INT64) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table2_id}
WHERE status != false AND EXTRACT(YEAR FROM month)=2023
UNION ALL
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,CAST(EXTRACT(MONTH FROM month) AS INT64) AS month_num,CAST(EXTRACT(YEAR FROM month) AS INT64) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table3_id}
WHERE status != false AND EXTRACT(YEAR FROM month)=2022
ORDER BY 2, 3
);

--Version NUEVA (Por los totales, cambia el month_num y year Y EL where):
CREATE OR REPLACE TABLE {table} AS (
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,EXTRACT(MONTH FROM PARSE_DATE('%B, %Y', region)) AS month_num,EXTRACT(YEAR FROM PARSE_DATE('%B, %Y', region)) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table1_id}
WHERE status != false
UNION ALL
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,EXTRACT(MONTH FROM PARSE_DATE('%B, %Y', region)) AS month_num,EXTRACT(YEAR FROM PARSE_DATE('%B, %Y', region)) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table2_id}
WHERE status != false AND RIGHT(region,4) = '2023'
UNION ALL
SELECT CAST(key AS STRING) AS key,month,region,rev_build_pc,payroll_pc,month_name,EXTRACT(MONTH FROM PARSE_DATE('%B, %Y', region)) AS month_num,EXTRACT(YEAR FROM PARSE_DATE('%B, %Y', region)) AS year,company_id,company_name,company_new_name,created_by,update_by,CAST(revenue_new_cust AS FLOAT64) AS revenue_new_cust,CAST(revenue_ncust__trend AS FLOAT64) AS revenue_ncust__trend,CAST(revenue_repeat_cust AS FLOAT64) AS revenue_repeat_cust,CAST(revenue_rcust__trend AS FLOAT64) AS revenue_rcust__trend,CAST(revenue_demand AS FLOAT64) AS revenue_demand,CAST(revenue_maint AS FLOAT64) AS revenue_maint,CAST(revenue_estimates AS FLOAT64) AS revenue_estimates,CAST(revenue_projects AS FLOAT64) AS revenue_projects,CAST(revenue_total AS FLOAT64) AS revenue_total,CAST(revenue_pace AS FLOAT64) AS revenue_pace,CAST(revenue_rev_trend AS FLOAT64) AS revenue_rev_trend,CAST(single_jobs_new_cust AS FLOAT64) AS single_jobs_new_cust,CAST(single_jobs_ncust__trend AS FLOAT64) AS single_jobs_ncust__trend,CAST(single_jobs_new_cust_ib AS FLOAT64) AS single_jobs_new_cust_ib,CAST(single_jobs_new_cust_ob AS FLOAT64) AS single_jobs_new_cust_ob,CAST(single_jobs_r_cust_ob AS FLOAT64) AS single_jobs_r_cust_ob,CAST(single_jobs_r_cust_ib AS FLOAT64) AS single_jobs_r_cust_ib,CAST(single_jobs_r_cust_ib_pace AS FLOAT64) AS single_jobs_r_cust_ib_pace,CAST(single_jobs_r_ib_trend AS FLOAT64) AS single_jobs_r_ib_trend,CAST(single_jobs_repeat_cust AS FLOAT64) AS single_jobs_repeat_cust,CAST(single_jobs_demand AS FLOAT64) AS single_jobs_demand,CAST(single_jobs_maint AS FLOAT64) AS single_jobs_maint,CAST(single_jobs_total AS FLOAT64) AS single_jobs_total,CAST(single_jobs_pace AS FLOAT64) AS single_jobs_pace,CAST(single_jobs_sj_trend AS FLOAT64) AS single_jobs_sj_trend,CAST(gba_new_cust AS FLOAT64) AS gba_new_cust,CAST(gba_r_cust AS FLOAT64) AS gba_r_cust,CAST(gba_demand AS FLOAT64) AS gba_demand,CAST(gba_maint AS FLOAT64) AS gba_maint,CAST(gba_actual AS FLOAT64) AS gba_actual,CAST(gba_pace AS FLOAT64) AS gba_pace,CAST(gba_trend AS FLOAT64) AS gba_trend,CAST(sold_estimates_actual AS FLOAT64) AS sold_estimates_actual,CAST(sold_estimates_pace AS FLOAT64) AS sold_estimates_pace,CAST(sold_estimates_trend AS FLOAT64) AS sold_estimates_trend,CAST(manpower_sj_qty AS FLOAT64) AS manpower_sj_qty,CAST(manpower_svc_avg AS FLOAT64) AS manpower_svc_avg,CAST(manpower_svc_pj_qty AS FLOAT64) AS manpower_svc_pj_qty,CAST(manpower_svc_prj_avg AS FLOAT64) AS manpower_svc_prj_avg,CAST(manpower_repl_pj_qty AS FLOAT64) AS manpower_repl_pj_qty,CAST(manpower_installer_avg AS FLOAT64) AS manpower_installer_avg,CAST(sold_hours_sj_svc_sold_hours AS FLOAT64) AS sold_hours_sj_svc_sold_hours,CAST(sold_hours_sj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_sold_hrs,CAST(sold_hours_sj_svc_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_worked_hrs,CAST(sold_hours_sj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_sj_svc_rev_worked_hrs,CAST(sold_hours_pj_svc_sold_hours AS FLOAT64) AS sold_hours_pj_svc_sold_hours,CAST(sold_hours_pj_svc_rev_sold_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_sold_hrs,CAST(sold_hours_pj_svc_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_worked_hrs,CAST(sold_hours_pj_svc_rev_worked_hrs AS FLOAT64) AS sold_hours_pj_svc_rev_worked_hrs,CAST(sold_hours_repl_sold_hours AS FLOAT64) AS sold_hours_repl_sold_hours,CAST(sold_hours_repl_rev_sold_hrs AS FLOAT64) AS sold_hours_repl_rev_sold_hrs,CAST(sold_hours_repl_worked_hours AS FLOAT64) AS sold_hours_repl_worked_hours,CAST(sold_hours_repl_rev_worked_hrs AS FLOAT64) AS sold_hours_repl_rev_worked_hrs,CAST(sold_hours_total_sold_hrs AS FLOAT64) AS sold_hours_total_sold_hrs,CAST(sj__usd_100_new_cust AS FLOAT64) AS sj__usd_100_new_cust,CAST(sj__usd_100_repeat_cust AS FLOAT64) AS sj__usd_100_repeat_cust,CAST(sj__usd_100_demand AS FLOAT64) AS sj__usd_100_demand,CAST(sj__usd_100_maint AS FLOAT64) AS sj__usd_100_maint,CAST(sj__usd_100_total AS FLOAT64) AS sj__usd_100_total,CAST(recalls_new_cust AS FLOAT64) AS recalls_new_cust,CAST(recalls_repeat_cust AS FLOAT64) AS recalls_repeat_cust,CAST(recalls_demand AS FLOAT64) AS recalls_demand,CAST(recalls_total AS FLOAT64) AS recalls_total,CAST(sj_repair_pct_new_cust AS FLOAT64) AS sj_repair_pct_new_cust,CAST(sj_repair_pct_repeat_cust AS FLOAT64) AS sj_repair_pct_repeat_cust,CAST(sj_repair_pct_demand AS FLOAT64) AS sj_repair_pct_demand,CAST(sj_repair_pct_maint AS FLOAT64) AS sj_repair_pct_maint,CAST(sj_repair_pct_total AS FLOAT64) AS sj_repair_pct_total,CAST(sj_repair_avg_usd_new_cust AS FLOAT64) AS sj_repair_avg_usd_new_cust,CAST(sj_repair_avg_usd_repeat_cust AS FLOAT64) AS sj_repair_avg_usd_repeat_cust,CAST(sj_repair_avg_usd_demand AS FLOAT64) AS sj_repair_avg_usd_demand,CAST(sj_repair_avg_usd_maint AS FLOAT64) AS sj_repair_avg_usd_maint,CAST(sj_repair_avg_usd_total AS FLOAT64) AS sj_repair_avg_usd_total,CAST(opportunity_to_pct_new_cust AS FLOAT64) AS opportunity_to_pct_new_cust,CAST(opportunity_to_pct_repeat_cust AS FLOAT64) AS opportunity_to_pct_repeat_cust,CAST(opportunity_to_pct_demand AS FLOAT64) AS opportunity_to_pct_demand,CAST(opportunity_to_pct_maint AS FLOAT64) AS opportunity_to_pct_maint,CAST(opportunity_to_pct_est AS FLOAT64) AS opportunity_to_pct_est,CAST(opportunity_to_pct_total AS FLOAT64) AS opportunity_to_pct_total,CAST(to_conversion_pct_new_cust AS FLOAT64) AS to_conversion_pct_new_cust,CAST(to_conversion_pct_repeat_cust AS FLOAT64) AS to_conversion_pct_repeat_cust,CAST(to_conversion_pct_demand AS FLOAT64) AS to_conversion_pct_demand,CAST(to_conversion_pct_maint AS FLOAT64) AS to_conversion_pct_maint,CAST(to_conversion_pct_total AS FLOAT64) AS to_conversion_pct_total,CAST(conversion_usd_avg_new_cust AS FLOAT64) AS conversion_usd_avg_new_cust,CAST(conversion_usd_avg_repeat_cust AS FLOAT64) AS conversion_usd_avg_repeat_cust,CAST(conversion_usd_avg_demand AS FLOAT64) AS conversion_usd_avg_demand,CAST(conversion_usd_avg_maint AS FLOAT64) AS conversion_usd_avg_maint,CAST(conversion_usd_avg_total AS FLOAT64) AS conversion_usd_avg_total,CAST(sj_mktestimates_new_cust AS FLOAT64) AS sj_mktestimates_new_cust,CAST(sj_mktestimates_repeat_cust AS FLOAT64) AS sj_mktestimates_repeat_cust,CAST(sj_mktestimates_estimates AS FLOAT64) AS sj_mktestimates_estimates,CAST(sj_mktestimates_total AS FLOAT64) AS sj_mktestimates_total,CAST(sj_mktestimates_pace AS FLOAT64) AS sj_mktestimates_pace,CAST(sj_mktestimates_est_trend AS FLOAT64) AS sj_mktestimates_est_trend,CAST(sj_mkte_conv_pct_new_cust AS FLOAT64) AS sj_mkte_conv_pct_new_cust,CAST(sj_mkte_conv_pct_repeat_cust AS FLOAT64) AS sj_mkte_conv_pct_repeat_cust,CAST(sj_mkte_conv_pct_demand AS FLOAT64) AS sj_mkte_conv_pct_demand,CAST(sj_mkte_conv_pct_maint AS FLOAT64) AS sj_mkte_conv_pct_maint,CAST(sj_mkte_conv_pct_estimates AS FLOAT64) AS sj_mkte_conv_pct_estimates,CAST(sj_mkte_conv_pct_total AS FLOAT64) AS sj_mkte_conv_pct_total,CAST(sj_mkte_conv_usd_new_cust AS FLOAT64) AS sj_mkte_conv_usd_new_cust,CAST(sj_mkte_conv_usd_repeat_cust AS FLOAT64) AS sj_mkte_conv_usd_repeat_cust,CAST(sj_mkte_conv_usd_estimates AS FLOAT64) AS sj_mkte_conv_usd_estimates,CAST(sj_mkte_conv_usd_total AS FLOAT64) AS sj_mkte_conv_usd_total,CAST(airflow_prj_mix_pct_new_cust AS FLOAT64) AS airflow_prj_mix_pct_new_cust,CAST(airflow_prj_mix_pct_repeat_cust AS FLOAT64) AS airflow_prj_mix_pct_repeat_cust,CAST(airflow_prj_mix_pct_total AS FLOAT64) AS airflow_prj_mix_pct_total,CAST(airflow_prj_mix_pct_demand AS FLOAT64) AS airflow_prj_mix_pct_demand,CAST(airflow_prj_mix_pct_maintenance AS FLOAT64) AS airflow_prj_mix_pct_maintenance,CAST(airflow_prj_mix_pct_estimates AS FLOAT64) AS airflow_prj_mix_pct_estimates,CAST(af_prj_avg_usd_new_cust AS FLOAT64) AS af_prj_avg_usd_new_cust,CAST(af_prj_avg_usd_repeat_cust AS FLOAT64) AS af_prj_avg_usd_repeat_cust,CAST(af_prj_avg_usd_total AS FLOAT64) AS af_prj_avg_usd_total,CAST(af_prj_avg_usd_count_prj_new AS FLOAT64) AS af_prj_avg_usd_count_prj_new,CAST(af_prj_avg_usd_count_prj_repeat AS FLOAT64) AS af_prj_avg_usd_count_prj_repeat,CAST(af_prj_avg_usd_total_prj AS FLOAT64) AS af_prj_avg_usd_total_prj,CAST(equip_mix_pct_new_cust AS FLOAT64) AS equip_mix_pct_new_cust,CAST(equip_mix_pct_repeat_cust AS FLOAT64) AS equip_mix_pct_repeat_cust,CAST(equip_mix_pct_total AS FLOAT64) AS equip_mix_pct_total,CAST(equip_mix_pct_demand AS FLOAT64) AS equip_mix_pct_demand,CAST(equip_mix_pct_maint AS FLOAT64) AS equip_mix_pct_maint,CAST(equip_mix_pct_estimates AS FLOAT64) AS equip_mix_pct_estimates,CAST(equip_avg_usd_new_cust AS FLOAT64) AS equip_avg_usd_new_cust,CAST(equip_avg_usd_repeat_cust AS FLOAT64) AS equip_avg_usd_repeat_cust,CAST(equip_avg_usd_total AS FLOAT64) AS equip_avg_usd_total,CAST(equip_avg_usd_demand AS FLOAT64) AS equip_avg_usd_demand,CAST(equip_avg_usd_maint AS FLOAT64) AS equip_avg_usd_maint,CAST(equip_avg_usd_estimates AS FLOAT64) AS equip_avg_usd_estimates,CAST(svc_prj_pct_new_cust AS FLOAT64) AS svc_prj_pct_new_cust,CAST(svc_prj_pct_repeat_cust AS FLOAT64) AS svc_prj_pct_repeat_cust,CAST(svc_prj_pct_demand AS FLOAT64) AS svc_prj_pct_demand,CAST(svc_prj_pct_maint AS FLOAT64) AS svc_prj_pct_maint,CAST(svc_prj_pct_estimates AS FLOAT64) AS svc_prj_pct_estimates,CAST(svc_prj_pct_total AS FLOAT64) AS svc_prj_pct_total,CAST(svc_prj_avg_usd_new_cust AS FLOAT64) AS svc_prj_avg_usd_new_cust,CAST(svc_prj_avg_usd_repeat_cust AS FLOAT64) AS svc_prj_avg_usd_repeat_cust,CAST(svc_prj_avg_usd_demand AS FLOAT64) AS svc_prj_avg_usd_demand,CAST(svc_prj_avg_usd_maint AS FLOAT64) AS svc_prj_avg_usd_maint,CAST(svc_prj_avg_usd_estimates AS FLOAT64) AS svc_prj_avg_usd_estimates,CAST(svc_prj_avg_usd_total AS FLOAT64) AS svc_prj_avg_usd_total,tab_title
FROM {table3_id}
WHERE status != false AND RIGHT(region,4) = '2022'
ORDER BY 2, 3
);